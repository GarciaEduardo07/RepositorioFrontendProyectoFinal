<div class="container-fluid mt-4">
    <h2>Habitaciones</h2>
    <div class="d-flex justify-content-between mb-3">
        <button (click)="toggleForm()" class="btn btn-success">
            <i class="fa fa-plus"></i> Registrar Habitación
        </button>
    </div>

    <table class="table table-striped table-hover table-dark">
        <thead class="table-dark">
            <tr style="text-align: center;">
                <th scope="col">#</th>
                <th scope="col">Número</th>
                <th scope="col">Tipo</th>
                <th scope="col">Precio</th>
                <th scope="col">Capacidad</th>
                <th scope="col">Estado</th>
                <th scope="col" *ngIf="showActions">Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr style="text-align: center;" *ngFor="let habitacion of listaHabitaciones; let i = index">
                <td>{{ i + 1 }}</td>
                <td class="fw-semibold">{{ habitacion.numero }}</td>
                <td>{{ habitacion.tipo }}</td>
                <td>${{ habitacion.precioNoche | number:'1.2-2' }}</td>
                <td>{{ habitacion.capacidad }}</td>
                <td>
                    <span class="badge" [ngClass]="habitacion.estado === 'DISPONIBLE' ? 'bg-success' : 'bg-danger'">
                        {{ habitacion.estado }}
                    </span>
                </td>
                <td *ngIf="showActions">
                    <button class="btn btn-primary btn-sm me-1" (click)="editHabitacion(habitacion)">
                        Editar
                    </button>
                    <button *ngIf="habitacion.estado === 'DISPONIBLE'" class="btn btn-danger btn-sm"
                        (click)="deleteHabitacion(habitacion.id)">
                        Eliminar
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <div *ngIf="listaHabitaciones.length === 0" class="text-center py-5 text-muted">
        <span *ngIf="showActions; else noData">No hay habitaciones registradas.</span>
        <ng-template #noData>No hay habitaciones disponibles.</ng-template>
    </div>

    <!-- Modal -->
    <div class="modal fade" #habitacionModalRef tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title">{{ modalText }}</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form [formGroup]="habitacionForm" (ngSubmit)="onSubmit()">
                        <div class="mb-3">
                            <label for="numero" class="form-label">Número de Habitación</label>
                            <input id="numero" type="text" class="form-control" formControlName="numero"
                                maxlength="10" />
                        </div>

                        <div class="mb-3">
                            <label for="idTipo" class="form-label">Tipo de Habitación</label>
                            <select id="idTipo" formControlName="idTipo" class="form-select">
                                <option [ngValue]="null" disabled selected>Seleccione el tipo</option>
                                <option *ngFor="let tipo of listaTipoHabitacion" [ngValue]="tipo.id">
                                    {{ tipo.label }}
                                </option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="precioNoche" class="form-label">Precio por Noche</label>
                            <input id="precioNoche" type="number" class="form-control" formControlName="precioNoche"
                                step="0.01" min="0" />
                        </div>

                        <div class="mb-3">
                            <label for="capacidad" class="form-label">Capacidad (Personas)</label>
                            <input id="capacidad" type="number" class="form-control" formControlName="capacidad"
                                min="1" />
                        </div>

                        <div class="mb-3">
                            <label for="idEstado" class="form-label">Estado</label>
                            <select id="idEstado" formControlName="idEstado" class="form-select">
                                <option [ngValue]="null" disabled selected>Seleccione el estado</option>
                                <option *ngFor="let estado of listaEstadoHabitacion" [ngValue]="estado.id">
                                    {{ estado.label }}
                                </option>
                            </select>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-success px-4" [disabled]="habitacionForm.invalid">
                                Guardar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>